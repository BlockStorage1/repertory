#!groovy

pipeline {
  agent any

  options {
    disableConcurrentBuilds()
  }

  stages {
    stage('configure') {
      steps {
        cmake arguments: '.. -DCMAKE_BUILD_TYPE=Release -DREPERTORY_ENABLE_S3=ON', installation: 'InSearchPath', workingDir: 'build'
      }
    }

    stage('build') {
      environment {
        PATH = "/usr/local/bin:${env.PATH}"
      }

      steps {
        cmake arguments: '--build . -j 8', installation: 'InSearchPath', workingDir: 'build'
      }
    }
  }
}
